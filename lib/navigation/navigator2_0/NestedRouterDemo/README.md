長くてわかりづらいんで、分割してみる
